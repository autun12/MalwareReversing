#!/usr/bin/env python3

def DecryptUnicodeStrings(encryptedUnicode):
	decryptedUnicode = []
	for i in encryptedUnicode:
		decryptAlg = chr(i ^ 0xAE12)
		decryptedUnicode.append(decryptAlg)
	print(str(decryptedUnicode).replace('[','').replace(']','').replace(',','').replace("'",'').replace(' ','').replace('\\x00',''))
	return decryptedUnicode

def DecryptAPIName(apiName):
	decryptedAPIName = []
	for i in apiName:
		decryptAlg = chr((i ^ 0x12))
		decryptedAPIName.append(decryptAlg)
	print(str(decryptedAPIName).replace('[','').replace(']','').replace(',','').replace("'",'').replace(' ','').replace('\\x00','').replace('Â¼',''))
	return decryptedAPIName

ENCODED_KERNEL32_DLL_ASLR__08x = [
	0xAE59, 0xAE57, 0xAE40, 0xAE5C,
	0xAE57, 0xAE5E, 0xAE21, 0xAE20,
	0xAE3C, 0xAE56, 0xAE5E, 0xAE5E,
	0xAE3C, 0xAE53, 0xAE41, 0xAE5E,
	0xAE40, 0xAE3C, 0xAE37, 0xAE22,
	0xAE2A, 0xAE6A, 0xAE12
]

ENCODED_lstrcmpiW = [
	0x7E, 0xAE, 0x61, 0xAE, 0x66, 0xAE, 0x60, 0xAE,
	0x71, 0xAE, 0x7F, 0xAE, 0x62, 0xAE, 0x7B, 0xAE,
	0x45, 0xAE, 0x12, 0xAE
]

ENCODED_VirtualQuery = [
	0x44, 0xAE, 0x7B, 0xAE, 0x60, 0xAE, 0x66, 0xAE,
	0x67, 0xAE, 0x73, 0xAE, 0x7E, 0xAE, 0x43, 0xAE,
	0x67, 0xAE, 0x77, 0xAE, 0x60, 0xAE, 0x6B, 0xAE,
	0x12, 0xAE
]

ENCODED_VirtualProtect = [
	0x44, 0xAE, 0x7B, 0xAE, 0x60, 0xAE, 0x66, 0xAE,
	0x67, 0xAE, 0x73, 0xAE, 0x7E, 0xAE, 0x42, 0xAE,
	0x60, 0xAE, 0x7D, 0xAE, 0x66, 0xAE, 0x77, 0xAE,
	0x71, 0xAE, 0x66, 0xAE, 0x12, 0xAE
]

ENCODED_GetProcAddress = [
	0x55, 0xAE, 0x77, 0xAE, 0x66, 0xAE, 0x42, 0xAE,
	0x60, 0xAE, 0x7D, 0xAE, 0x71, 0xAE, 0x53, 0xAE,
	0x76, 0xAE, 0x76, 0xAE, 0x60, 0xAE, 0x77, 0xAE,
	0x61, 0xAE, 0x61, 0xAE, 0x12, 0xAE
]

ENCODED_MapViewOfFile = [
	0x5F, 0xAE, 0x73, 0xAE, 0x62, 0xAE, 0x44, 0xAE,
	0x7B, 0xAE, 0x77, 0xAE, 0x65, 0xAE, 0x5D, 0xAE,
	0x74, 0xAE, 0x54, 0xAE, 0x7B, 0xAE, 0x7E, 0xAE,
	0x77, 0xAE, 0x12, 0xAE
]

ENCODED_UnmapViewOfFile = [
	0x47, 0xAE, 0x7C, 0xAE, 0x7F, 0xAE, 0x73, 0xAE,
	0x62, 0xAE, 0x44, 0xAE, 0x7B, 0xAE, 0x77, 0xAE,
	0x65, 0xAE, 0x5D, 0xAE, 0x74, 0xAE, 0x54, 0xAE,
	0x7B, 0xAE, 0x7E, 0xAE, 0x77, 0xAE, 0x12, 0xAE
]

ENCODED_FlushInstructionCache = [
	0x54, 0xAE, 0x7E, 0xAE, 0x67, 0xAE, 0x61, 0xAE,
	0x7A, 0xAE, 0x5B, 0xAE, 0x7C, 0xAE, 0x61, 0xAE,
	0x66, 0xAE, 0x60, 0xAE, 0x67, 0xAE, 0x71, 0xAE,
	0x66, 0xAE, 0x7B, 0xAE, 0x7D, 0xAE, 0x7C, 0xAE,
	0x51, 0xAE, 0x73, 0xAE, 0x71, 0xAE, 0x7A, 0xAE,
	0x77, 0xAE, 0x12, 0xAE
]

ENCODED_LoadLibraryW = [
	0x5E, 0xAE, 0x7D, 0xAE, 0x73, 0xAE, 0x76, 0xAE,
	0x5E, 0xAE, 0x7B, 0xAE, 0x70, 0xAE, 0x60, 0xAE,
	0x73, 0xAE, 0x60, 0xAE, 0x6B, 0xAE, 0x45, 0xAE,
	0x12, 0xAE
]

ENCODED_FreeLibrary = [
	0x54, 0xAE, 0x60, 0xAE, 0x77, 0xAE, 0x77, 0xAE,
	0x5E, 0xAE, 0x7B, 0xAE, 0x70, 0xAE, 0x60, 0xAE,
	0x73, 0xAE, 0x60, 0xAE, 0x6B, 0xAE, 0x12, 0xAE
]

ENCODED_ZwCreateSection = [
	0x48, 0xAE, 0x65, 0xAE, 0x51, 0xAE, 0x60, 0xAE,
	0x77, 0xAE, 0x73, 0xAE, 0x66, 0xAE, 0x77, 0xAE,
	0x41, 0xAE, 0x77, 0xAE, 0x71, 0xAE, 0x66, 0xAE,
	0x7B, 0xAE, 0x7D, 0xAE, 0x7C, 0xAE, 0x12, 0xAE
]

ENCODED_ZwMapViewOfSection = [
	0x48, 0xAE, 0x65, 0xAE, 0x5F, 0xAE, 0x73, 0xAE,
	0x62, 0xAE, 0x44, 0xAE, 0x7B, 0xAE, 0x77, 0xAE,
	0x65, 0xAE, 0x5D, 0xAE, 0x74, 0xAE, 0x41, 0xAE,
	0x77, 0xAE, 0x71, 0xAE, 0x66, 0xAE, 0x7B, 0xAE,
	0x7D, 0xAE, 0x7C, 0xAE, 0x12, 0xAE
]

ENCODED_CreateThread = [
	0x51, 0xAE, 0x60, 0xAE, 0x77, 0xAE, 0x73, 0xAE,
	0x66, 0xAE, 0x77, 0xAE, 0x46, 0xAE, 0x7A, 0xAE,
	0x60, 0xAE, 0x77, 0xAE, 0x73, 0xAE, 0x76, 0xAE,
	0x12, 0xAE
]

ENCODED_WaitForSingleObject = [
	0x45, 0xAE, 0x73, 0xAE, 0x7B, 0xAE, 0x66, 0xAE,
	0x54, 0xAE, 0x7D, 0xAE, 0x60, 0xAE, 0x41, 0xAE,
	0x7B, 0xAE, 0x7C, 0xAE, 0x75, 0xAE, 0x7E, 0xAE,
	0x77, 0xAE, 0x5D, 0xAE, 0x70, 0xAE, 0x78, 0xAE,
	0x77, 0xAE, 0x71, 0xAE, 0x66, 0xAE, 0x12, 0xAE
]

ENCODED_GetExitCodeThread = [
	0x55, 0xAE, 0x77, 0xAE, 0x66, 0xAE, 0x57, 0xAE,
	0x6A, 0xAE, 0x7B, 0xAE, 0x66, 0xAE, 0x51, 0xAE,
	0x7D, 0xAE, 0x76, 0xAE, 0x77, 0xAE, 0x46, 0xAE,
	0x7A, 0xAE, 0x60, 0xAE, 0x77, 0xAE, 0x73, 0xAE,
	0x76, 0xAE, 0x12, 0xAE
]

ENCODED_ZwClose = [
	0x48, 0xAE, 0x65, 0xAE, 0x51, 0xAE, 0x7E, 0xAE,
	0x7D, 0xAE, 0x61, 0xAE, 0x77, 0xAE, 0x12, 0xAE
]

ENCODED_CreateRemoteThread = [
	0x51, 0xAE, 0x60, 0xAE, 0x77, 0xAE, 0x73, 0xAE,
	0x66, 0xAE, 0x77, 0xAE, 0x40, 0xAE, 0x77, 0xAE,
	0x7F, 0xAE, 0x7D, 0xAE, 0x66, 0xAE, 0x77, 0xAE,
	0x46, 0xAE, 0x7A, 0xAE, 0x60, 0xAE, 0x77, 0xAE,
	0x73, 0xAE, 0x76, 0xAE, 0x12, 0xAE
]

ENCODED_NtCreateThreadEx = [
	0x5C, 0xAE, 0x66, 0xAE, 0x51, 0xAE, 0x60, 0xAE,
	0x77, 0xAE, 0x73, 0xAE, 0x66, 0xAE, 0x77, 0xAE,
	0x46, 0xAE, 0x7A, 0xAE, 0x60, 0xAE, 0x77, 0xAE,
	0x73, 0xAE, 0x76, 0xAE, 0x57, 0xAE, 0x6A, 0xAE,
	0x12, 0xAE
]

ENCODED_KERNEL32_DLL = [
	0xAE79, 0xAE77, 0xAE60, 0xAE7C,
	0xAE77, 0xAE7E, 0xAE21, 0xAE20,
	0xAE3C, 0xAE76, 0xAE7E, 0xAE7E,
	0xAE12
]

ENCODED_NTDLL_DLL = [
	0xAE7C, 0xAE66, 0xAE76, 0xAE7E,
	0xAE7E, 0xAE3C, 0xAE76, 0xAE7E,
	0xAE7E, 0xAE12
]

DecryptUnicodeStrings(ENCODED_KERNEL32_DLL_ASLR__08x)
DecryptAPIName(ENCODED_lstrcmpiW)
DecryptAPIName(ENCODED_VirtualQuery)
DecryptAPIName(ENCODED_VirtualProtect)
DecryptAPIName(ENCODED_GetProcAddress)
DecryptAPIName(ENCODED_MapViewOfFile)
DecryptAPIName(ENCODED_UnmapViewOfFile)
DecryptAPIName(ENCODED_FlushInstructionCache)
DecryptAPIName(ENCODED_LoadLibraryW)
DecryptAPIName(ENCODED_FreeLibrary)
DecryptAPIName(ENCODED_ZwCreateSection)
DecryptAPIName(ENCODED_ZwMapViewOfSection)
DecryptAPIName(ENCODED_CreateThread)
DecryptAPIName(ENCODED_WaitForSingleObject)
DecryptAPIName(ENCODED_GetExitCodeThread)
DecryptAPIName(ENCODED_ZwClose)
DecryptAPIName(ENCODED_CreateRemoteThread)
DecryptAPIName(ENCODED_NtCreateThreadEx)
DecryptUnicodeStrings(ENCODED_KERNEL32_DLL)
DecryptUnicodeStrings(ENCODED_NTDLL_DLL)